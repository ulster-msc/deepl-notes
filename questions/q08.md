![Question 8](https://github.com/ulster-msc/deepl-notes/blob/main/questions/Screenshot%202025-11-06%20at%2015.32.16.png?raw=true)

Question 8 — Iris MLP with 3 hidden layers, save/load, predict

Design choices explained
- The task requires three hidden layers: 20 relu → 10 tanh → 8 sigmoid. The final layer is softmax because Iris has three classes and the instruction explicitly says “The final layer is with ‘softmax’ activation function (think about why?)”. Softmax gives a probability distribution over the three classes.
- We encode labels to integers (0,1,2) and use `sparse_categorical_crossentropy`, which matches integer labels and softmax output.
- After training, the model is saved and reloaded to demonstrate persistence before making a prediction on `[5.1, 3.5, 1.4, 0.2]`.

Complete program
```python
from numpy import argmax
from pandas import read_csv
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import LabelEncoder
from tensorflow.keras import Sequential
from tensorflow.keras.layers import Dense
from tensorflow.keras.models import load_model
import numpy as np

# load the dataset
path = 'https://raw.githubusercontent.com/jbrownlee/Datasets/master/iris.csv'
df = read_csv(path, header=None)

# split into input and output columns
X, y = df.values[:, :-1], df.values[:, -1]

# ensure float data
X = X.astype('float32')

# encode class labels to integers 0..2
y = LabelEncoder().fit_transform(y)

# split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)

n_features = X_train.shape[1]

# model: 3 hidden layers (20 relu, 10 tanh, 8 sigmoid) + softmax
model = Sequential()
model.add(Dense(20, activation='relu', input_shape=(n_features,)))
model.add(Dense(10, activation='tanh'))
model.add(Dense(8, activation='sigmoid'))
model.add(Dense(3, activation='softmax'))

model.compile(optimizer='adam',
              loss='sparse_categorical_crossentropy',
              metrics=['accuracy'])

model.fit(X_train, y_train, epochs=200, batch_size=32, verbose=0)

# save and load
model.save('iris_mlp.h5')
restored = load_model('iris_mlp.h5')

# predict given array [5.1,3.5,1.4,0.2]
sample = np.array([[5.1, 3.5, 1.4, 0.2]], dtype='float32')
yhat = restored.predict(sample, verbose=0)
print('probabilities:', yhat[0])
print('predicted class:', int(argmax(yhat)))
```

References (lectures/practicals used)
- lectures/Lecture 3-2025.pdf — p.5–6 (MLP classification with softmax and compile line)
- practicals/Practice - W4 - Answers.pdf — p.3 (Iris multi‑class classification exercise)
