![Question 6](https://github.com/ulster-msc/deepl-notes/blob/main/questions/Screenshot%202025-11-06%20at%2015.31.50.png?raw=true)

Question 6 — OneHotEncoder usage and output

Detailed explanation

**Understanding OneHotEncoder from sklearn:**

The `OneHotEncoder` class from scikit-learn converts categorical features into a one-hot numeric array. Key properties:
- Input must be 2D: shape (n_samples, n_features)
- By default, categories are sorted **lexicographically (alphabetically)**
- Each unique category becomes its own binary column
- The method `fit_transform()` learns categories and transforms in one step

**Step-by-step solution:**

**Step 1: Prepare the input data**
```python
encoder.fit_transform(['red', 'blue', 'green', 'blue'])
```

The input list has 4 values, but OneHotEncoder expects a 2D array:
```python
# Reshape to (4 samples, 1 feature)
X = np.array(['red', 'blue', 'green', 'blue']).reshape(-1, 1)
```

**Step 2: Understand the category ordering**

The unique values are: {'red', 'blue', 'green'}

OneHotEncoder sorts these **alphabetically**:
1. 'blue'   → column 0
2. 'green'  → column 1
3. 'red'    → column 2

**Step 3: Apply the encoding**

Each sample gets encoded based on which column represents its category:

| Input   | Column 0 (blue) | Column 1 (green) | Column 2 (red) | One-hot vector |
|---------|-----------------|------------------|----------------|----------------|
| 'red'   | 0               | 0                | 1              | [0, 0, 1]      |
| 'blue'  | 1               | 0                | 0              | [1, 0, 0]      |
| 'green' | 0               | 1                | 0              | [0, 1, 0]      |
| 'blue'  | 1               | 0                | 0              | [1, 0, 0]      |

**Final result:**
```python
array([[0., 0., 1.],   # red
       [1., 0., 0.],   # blue
       [0., 1., 0.],   # green
       [1., 0., 0.]])  # blue
```

Code
```python
import numpy as np
from sklearn.preprocessing import OneHotEncoder

encoder = OneHotEncoder(sparse=False, handle_unknown='ignore')
X = np.array(['red', 'blue', 'green', 'blue']).reshape(-1, 1)
result = encoder.fit_transform(X)

print(encoder.categories_)  # [array(['blue', 'green', 'red'], dtype='<U5')]
print(result)
# array([
#   [0., 0., 1.],  # red
#   [1., 0., 0.],  # blue
#   [0., 1., 0.],  # green
#   [1., 0., 0.],  # blue
# ])
```

References (lectures/practicals used)
- practicals/Practice - W3 - Answer.pdf — p.3 (categorical label encoding via LabelEncoder prior to model training)
- lectures/Lecture 3-2025.pdf — p.6 (softmax multi‑class pipeline context; complements one‑hot representation rationale)
